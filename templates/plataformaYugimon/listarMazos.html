{% extends 'base/base.html' %}
{% block contenido %}

    <h1 class="mb-4">Lista de Mazos</h1>

    <a href="{% url 'crearMazo' %}" class="btn btn-primary mb-3">Crear nuevo mazo</a>

    <table id="example_mazos" class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Descripción</th>
                <th>Autor</th>
                <th>Puntuación</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for mazo in mazos %}
            <tr>
                <td>{{ mazo.id }}</td>
                <td>{{ mazo.nombre }}</td>
                <td>{{ mazo.descripcion }}</td>
                <td>{{ mazo.id_usuario.username }}</td>
                <td>{{ mazo.puntuacion_promedio }}/5</td>
                <td>
                    {% if request.user.is_authenticated and request.user.id == mazo.id_usuario_id %}
                    <a href="{% url 'editar_mazo' mazo.id %}" class="btn btn-warning btn-sm">Editar</a>
                    {% endif %}
                    <a href="{% url 'verMazo' mazo.id %}" class="btn btn-info btn-sm">Ver</a>
                    {% if request.user.is_authenticated and request.user.id == mazo.id_usuario_id %}
                    <form method="post" action="{% url 'eliminarMazo' mazo.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center">No hay mazos creados aún.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/2.3.4/js/dataTables.js"></script>
    <script src="https://cdn.datatables.net/2.3.4/js/dataTables.bootstrap5.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.2.5/js/dataTables.buttons.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.2.5/js/buttons.bootstrap5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.2.5/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.2.5/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.2.5/js/buttons.colVis.min.js"></script>

    
    <script>
        var table = new DataTable('#example_mazos', {
            language: {
            url: 'https://cdn.datatables.net/plug-ins/2.3.4/i18n/es-ES.json',
            },
            layout: {
                topStart: {
                    buttons: ['copy', 'excel', 'pdf', 'colvis']
                }
            }
        });
    </script>

{% endblock %}
